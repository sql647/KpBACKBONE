assign(paste0("g",i),read.table(paste0("./out_vcf/pop1_",i,"0000.vcf"), skip = 13, header = TRUE,
sep = "\t",comment.char = "",check.names = FALSE))
for (i in c(1:10)) {
assign(paste0("g",i),read.table(paste0("./out_vcf/pop1_",i,"0000.vcf"), skip = 13, header = TRUE,
sep = "\t",comment.char = "",check.names = FALSE))
}
View(g1)
length(unique(g1$POS))
for (i in c(1:10)) {
current_df <- get(paste0("g", i))  # 获取当前的数据框
current_df <- current_df[,c(2,10:509)]
colnames(current_df)[2:101] <- paste0("pop",i,"_",c(1:500))
assign(paste0("g", i), current_df)  # 将修改后的数据框重新赋值
}
View(g1)
for (i in c(1:10)) {
assign(paste0("g",i),read.table(paste0("./out_vcf/pop1_",i,"0000.vcf"), skip = 13, header = TRUE,
sep = "\t",comment.char = "",check.names = FALSE))
}
View(g1)
current_df <- get(paste0("g", i))  # 获取当前的数据框
View(current_df)
current_df$ID <- current_df$POS
for (i in c(1:10)) {
current_df <- get(paste0("g", i))  # 获取当前的数据框
current_df$ID <- current_df$POS
colnames(current_df)[10:509] <- paste0("pop1","_",c(1:500))
assign(paste0("g", i), current_df)  # 将修改后的数据框重新赋值
}
View(g1)
View(g10)
for (i in c(1:10)) {
assign(paste0("g",i),read.table(paste0("./out_vcf/pop1_",i,"0000.vcf"), skip = 13, header = TRUE,
sep = "\t",comment.char = "",check.names = FALSE))
}
for (i in c(1:10)) {
current_df <- get(paste0("g", i))  # 获取当前的数据框
current_df$ID <- current_df$POS
colnames(current_df)[10:509] <- paste0("pop1","_",c(1:500))
write.table(current_df,paste0("vcf_pops/pop1_generation_",i,"0000.vcf"),
sep = "\t",col.names = TRUE,row.names = FALSE,quote = FALSE)
assign(paste0("g", i), current_df)  # 将修改后的数据框重新赋值
}
for (i in c(1:10)) {
assign(paste0("g",i),read.table(paste0("./out_vcf/pop1_",i,"0000.vcf"), skip = 13, header = TRUE,
sep = "\t",comment.char = "",check.names = FALSE))
}
for (i in c(1:10)) {
current_df <- get(paste0("g", i))  # 获取当前的数据框
current_df$ID <- current_df$POS
colnames(current_df)[10:509] <- paste0("pop1","_",c(1:500))
write.table(current_df,paste0("vcf_pop/pop1_generation_",i,"0000.vcf"),
sep = "\t",col.names = TRUE,row.names = FALSE,quote = FALSE)
assign(paste0("g", i), current_df)  # 将修改后的数据框重新赋值
}
###matrix
for (i in c(1:10)) {
pop<-get(paste0("g", i))
ma<-pop[c("POS",paste0("pop1_",c(1:500)))]
ma[ma==0]<-"A"
ma[ma==1]<-"T"
write.table(ma,paste0("vcf_pop/pop1_G",i,"0000.MajorAMinorT"),row.names = FALSE,col.names = TRUE,
sep = "\t",quote = FALSE)
}
View(current_df)
View(g1)
for (i in c(1:10)) {
assign(paste0("g",i),read.table(paste0("./out_vcf/pop1_",i,"0000.vcf"), skip = 13, header = TRUE,
sep = "\t",comment.char = "",check.names = FALSE,stringsAsFactors = FALSE))
}
View(g1)
for (i in c(1:10)) {
assign(paste0("g",i),read.table(paste0("./out_vcf/pop1_",i,"0000.vcf"), skip = 13, header = TRUE,
sep = "\t",comment.char = "",check.names = FALSE,
stringsAsFactors = FALSE))
}
head(g1)
for (i in c(1:10)) {
assign(paste0("g",i),read.table(paste0("./out_vcf/pop1_",i,"0000.vcf"), skip = 13, header = TRUE,
sep = "\t",comment.char = "",check.names = FALSE,
stringsAsFactors = FALSE))
}
for (i in c(1:10)) {
current_df <- get(paste0("g", i))  # 获取当前的数据框
current_df$ID <- current_df$POS
colnames(current_df)[10:509] <- paste0("pop1","_",c(1:500))
current_df$ALT<-"T"
write.table(current_df,paste0("vcf_pop/pop1_generation_",i,"0000.vcf"),
sep = "\t",col.names = TRUE,row.names = FALSE,quote = FALSE)
assign(paste0("g", i), current_df)  # 将修改后的数据框重新赋值
}
View(g1)
###matrix
for (i in c(1:10)) {
pop<-get(paste0("g", i))
ma<-pop[c("POS",paste0("pop1_",c(1:500)))]
ma[ma==0]<-"A"
ma[ma==1]<-"T"
write.table(ma,paste0("vcf_pop/pop1_G",i,"0000.MajorAMinorT"),row.names = FALSE,col.names = TRUE,
sep = "\t",quote = FALSE)
}
View(ma)
View(g1)
###g10000
g1<-read.table("./out_vcf/pop1_100000.vcf",
skip = 13, header = TRUE,
sep = "\t", comment.char = "", check.names = FALSE,
stringsAsFactors = FALSE)
###g10000
g1<-read.table("./out_vcf/pop1_10000.vcf",
skip = 13, header = TRUE,
sep = "\t", comment.char = "", check.names = FALSE,
stringsAsFactors = FALSE)
