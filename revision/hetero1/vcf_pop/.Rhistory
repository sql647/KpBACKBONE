axis.title.x = element_text(size = 16),  # 设置x轴标题的字体大小（如果需要的话）
axis.title.y = element_text(size = 16),
legend.text = element_text(size = 16),
legend.key.size = unit(2, "lines"),
legend.position = "none")+
annotation_custom(grob = scree_grob, xmin = -800, xmax = -50, ymin = -1, ymax = 0)
ggplot(x,aes(score,PC1,color=PC1))+
geom_point(size=5,alpha=0.5)+
geom_smooth(method = "lm") +
stat_cor(size = 6,label.x = -200, label.y = -0.5,label.sep = "\n") +
theme_light()+scale_color_viridis(
option = "H",  # 使用 Viridis 渐变色
name = "PC1"  # 图例标题
)+
xlab("Trait Value") +
ylab("PC1")+
theme(legend.title = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_rect(colour = "black", fill = NA, linewidth = 1),
axis.text.x = element_text(size = 14),   # 设置x轴刻度标签的字体大小
axis.text.y = element_text(size = 14),   # 设置y轴刻度标签的字体大小
axis.title.x = element_text(size = 16),  # 设置x轴标题的字体大小（如果需要的话）
axis.title.y = element_text(size = 16),
legend.text = element_text(size = 16),
legend.key.size = unit(2, "lines"),
legend.position = "none")+
annotation_custom(grob = scree_grob, xmin = -800, xmax = -100, ymin = -1, ymax = 0)
ggplot(x,aes(score,PC1,color=PC1))+
geom_point(size=5,alpha=0.5)+
geom_smooth(method = "lm") +
stat_cor(size = 6,label.x = 200, label.y = 0.5,label.sep = "\n") +
theme_light()+scale_color_viridis(
option = "H",  # 使用 Viridis 渐变色
name = "PC1"  # 图例标题
)+
xlab("Trait Value") +
ylab("PC1")+
theme(legend.title = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_rect(colour = "black", fill = NA, linewidth = 1),
axis.text.x = element_text(size = 14),   # 设置x轴刻度标签的字体大小
axis.text.y = element_text(size = 14),   # 设置y轴刻度标签的字体大小
axis.title.x = element_text(size = 16),  # 设置x轴标题的字体大小（如果需要的话）
axis.title.y = element_text(size = 16),
legend.text = element_text(size = 16),
legend.key.size = unit(2, "lines"),
legend.position = "none")+
annotation_custom(grob = scree_grob, xmin = -800, xmax = -100, ymin = -1, ymax = 0)
ggplot(x,aes(score,PC1,color=PC1))+
geom_point(size=5,alpha=0.5)+
geom_smooth(method = "lm") +
stat_cor(size = 6,label.x = 200, label.y = 0.5,label.sep = "\n") +
theme_light()+scale_color_viridis(
option = "H",  # 使用 Viridis 渐变色
name = "PC1"  # 图例标题
)+
xlab("Trait Value") +
ylab("PC1")+
theme(legend.title = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_rect(colour = "black", fill = NA, linewidth = 1),
axis.text.x = element_text(size = 14),   # 设置x轴刻度标签的字体大小
axis.text.y = element_text(size = 14),   # 设置y轴刻度标签的字体大小
axis.title.x = element_text(size = 16),  # 设置x轴标题的字体大小（如果需要的话）
axis.title.y = element_text(size = 16),
legend.text = element_text(size = 16),
legend.key.size = unit(2, "lines"),
legend.position = "none")+
annotation_custom(grob = scree_grob, xmin = -800, xmax = -70, ymin = -1, ymax = 0)
ggplot(x,aes(score,PC1,color=PC1))+
geom_point(size=5,alpha=0.5)+
geom_smooth(method = "lm") +
stat_cor(size = 6,label.x = 200, label.y = 0.5,label.sep = "\n") +
theme_light()+scale_color_viridis(
option = "H",  # 使用 Viridis 渐变色
name = "PC1"  # 图例标题
)+
xlab("Trait Value") +
ylab("PC1")+
theme(legend.title = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_rect(colour = "black", fill = NA, linewidth = 1),
axis.text.x = element_text(size = 14),   # 设置x轴刻度标签的字体大小
axis.text.y = element_text(size = 14),   # 设置y轴刻度标签的字体大小
axis.title.x = element_text(size = 16),  # 设置x轴标题的字体大小（如果需要的话）
axis.title.y = element_text(size = 16),
legend.text = element_text(size = 16),
legend.key.size = unit(2, "lines"),
legend.position = "none")+
annotation_custom(grob = scree_grob, xmin = -900, xmax = -70, ymin = -1, ymax = 0)
library(ggtree)
library(treeio)
library(cowplot)
library(ggplot2)
sdf<-read.table("../score_m1m2/score_g10000.txt",header = TRUE)
f<-read.table("../score_m1m2/fitness10000.txt",header=TRUE)
sdf$fitness<-f$fitness
library(ggsci)
d<-ggplot(sdf, aes(x = scores_G10000)) +
# 绘制密度图
geom_density(aes(fill = "Density"), alpha = 0.6,
color = pal_lancet("lanonc")(1), size = 1) +
# 添加 Fitness 的填充区域和边框线
geom_area(aes(y = fitness / 2000, fill = "Fitness"), alpha = 0.5, size = 1) +
geom_line(aes(y = fitness / 2000), color = pal_lancet("lanonc")(2)[2], size = 1) +
# 设置坐标轴标题和图例
labs(
x = "Trait Value",
y = "Density",
fill = NULL  # 去掉填充图例的标题
) +
# 主 y 轴和辅助 y 轴
scale_y_continuous(
name = "Density",
sec.axis = sec_axis(~.*2000, name = "Fitness")
) +
# 自定义颜色和图例
scale_fill_manual(
values = c("Density" = pal_lancet("lanonc")(1), "Fitness" = pal_lancet("lanonc")(2)[2]),
guide = guide_legend(override.aes = list(
color = "black",
size = 1
))
) +
# 美化主题
theme_light() +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_rect(colour = "black", fill = NA, linewidth = 1),
axis.text.x = element_text(size = 14),   # 设置x轴刻度标签的字体大小
axis.text.y = element_text(size = 14),   # 设置y轴刻度标签的字体大小
axis.title.x = element_text(size = 16),  # 设置x轴标题的字体大小（如果需要的话）
axis.title.y = element_text(size = 16),  # 设置y轴标题的字体大小（如果需要的话）
plot.title = element_text(size = 20),
legend.position =c(0.5,0.7),
legend.text = element_text(size = 16),
legend.title = element_text(size = 20),
legend.box.margin = margin(5, 5, 5, 5),  # 图例间距
)
d
library(ggtree)
library(treeio)
library(cowplot)
library(ggplot2)
t<-read.newick("pop1_10000.FastTree")
t<-read.newick("pop2_10000.FastTree")
ggtree(t,layout = "ape")+
geom_treescale(offset = 0.005,fontsize=5, linesize=1, x=0, y=0,width=0.01)
###vis_PCA
pca <- read.table("pop2maf002pca.eigenvec")
eigenval <- scan("pop2maf002pca.eigenval")
# remove nuisance column
rownames(pca)<-pca$V1
pca <- pca[,-c(1,2)]
colnames(pca) <- paste0("PC", 1:ncol(pca))
val<-read.table("pop1maf002pca.eigenval")
colnames(val)<-"val"
###vis_PCA
pca <- read.table("pop2maf002pca.eigenvec")
eigenval <- scan("pop2maf002pca.eigenval")
# remove nuisance column
rownames(pca)<-pca$V1
pca <- pca[,-c(1,2)]
colnames(pca) <- paste0("PC", 1:ncol(pca))
val<-read.table("pop2maf002pca.eigenval")
colnames(val)<-"val"
rownames(val)<-paste0("PC", 1:nrow(val))
pca<-as.data.frame(t(t(pca)*sqrt(val$val)))
# set names
pca$ID<-rownames(pca)
##pve
pve <- data.frame(PC = 1:20, pve = eigenval/sum(eigenval)*100)
library(ggplot2)
ggplot(pve, aes(PC, pve)) + geom_bar(stat = "identity") +
ylab("Percentage variance explained") + theme_light()+
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_rect(colour = "black", fill = NA, linewidth = 1),
axis.text.x = element_text(size = 14),   # 设置x轴刻度标签的字体大小
axis.text.y = element_text(size = 14),   # 设置y轴刻度标签的字体大小
axis.title.x = element_text(size = 16),  # 设置x轴标题的字体大小（如果需要的话）
axis.title.y = element_text(size = 16),   # 设置y轴标题的字体大小（如果需要的话）
plot.title = element_text(size = 20)
)+
xlab("Principle Component")+
ggtitle("Scree Plot")
###
###
#
library(grid)
a<-ggplot(pve, aes(PC, pve)) + geom_bar(stat = "identity") +
ylab("PVE") + theme_light()+
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_rect(colour = "black", fill = NA, linewidth = 1),
axis.text.x = element_text(size = 12),   # 设置x轴刻度标签的字体大小
axis.text.y = element_text(size = 12),   # 设置y轴刻度标签的字体大小
axis.title.x = element_text(size = 13),  # 设置x轴标题的字体大小（如果需要的话）
axis.title.y = element_text(size = 13),   # 设置y轴标题的字体大小（如果需要的话）
plot.title = element_text(size = 12)
)+
xlab("Principal Component")+
ggtitle("Scree Plot")
scree_grob <- ggplotGrob(a)
ggplot(pca,aes(x=PC1,y=PC2))+
geom_point(size=5,alpha=0.5)+
theme_light()+
xlab(paste0("PC1 (", signif(pve$pve[1], 3), "%)")) +
ylab(paste0("PC2 (", signif(pve$pve[2], 3), "%)"))+
theme(legend.title = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_rect(colour = "black", fill = NA, linewidth = 1),
axis.text.x = element_text(size = 14),   # 设置x轴刻度标签的字体大小
axis.text.y = element_text(size = 14),   # 设置y轴刻度标签的字体大小
axis.title.x = element_text(size = 16),  # 设置x轴标题的字体大小（如果需要的话）
axis.title.y = element_text(size = 16),
legend.text = element_text(size = 16),
legend.key.size = unit(2, "lines"))+
annotation_custom(grob = scree_grob, xmin = -1, xmax = -0.2, ymin = -0.9, ymax = -0.1)
ggplot(pca,aes(x=PC1,y=PC2))+
geom_point(size=5,alpha=0.5)+
theme_light()+
xlab(paste0("PC1 (", signif(pve$pve[1], 3), "%)")) +
ylab(paste0("PC2 (", signif(pve$pve[2], 3), "%)"))+
theme(legend.title = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_rect(colour = "black", fill = NA, linewidth = 1),
axis.text.x = element_text(size = 14),   # 设置x轴刻度标签的字体大小
axis.text.y = element_text(size = 14),   # 设置y轴刻度标签的字体大小
axis.title.x = element_text(size = 16),  # 设置x轴标题的字体大小（如果需要的话）
axis.title.y = element_text(size = 16),
legend.text = element_text(size = 16),
legend.key.size = unit(2, "lines"))+
annotation_custom(grob = scree_grob, xmin = -0.8, xmax = 0.2, ymin = 0.4, ymax = 0.9)
ggplot(pca,aes(x=PC1,y=PC2))+
geom_point(size=5,alpha=0.5)+
theme_light()+
xlab(paste0("PC1 (", signif(pve$pve[1], 3), "%)")) +
ylab(paste0("PC2 (", signif(pve$pve[2], 3), "%)"))+
theme(legend.title = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_rect(colour = "black", fill = NA, linewidth = 1),
axis.text.x = element_text(size = 14),   # 设置x轴刻度标签的字体大小
axis.text.y = element_text(size = 14),   # 设置y轴刻度标签的字体大小
axis.title.x = element_text(size = 16),  # 设置x轴标题的字体大小（如果需要的话）
axis.title.y = element_text(size = 16),
legend.text = element_text(size = 16),
legend.key.size = unit(2, "lines"))+
annotation_custom(grob = scree_grob, xmin = -0.8, xmax = 0.2, ymin = 0.4, ymax = 1.1)
ggplot(pca,aes(x=PC1,y=PC2))+
geom_point(size=5,alpha=0.5)+
theme_light()+
xlab(paste0("PC1 (", signif(pve$pve[1], 3), "%)")) +
ylab(paste0("PC2 (", signif(pve$pve[2], 3), "%)"))+
theme(legend.title = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_rect(colour = "black", fill = NA, linewidth = 1),
axis.text.x = element_text(size = 14),   # 设置x轴刻度标签的字体大小
axis.text.y = element_text(size = 14),   # 设置y轴刻度标签的字体大小
axis.title.x = element_text(size = 16),  # 设置x轴标题的字体大小（如果需要的话）
axis.title.y = element_text(size = 16),
legend.text = element_text(size = 16),
legend.key.size = unit(2, "lines"))+
annotation_custom(grob = scree_grob, xmin = -0.8, xmax = 0.3, ymin = 0.4, ymax = 1.1)
###
##strain loadings
pca<-read.table("pop2maf002pca.eigenvec")
rownames(pca)<-pca$V1
pca$V1<-NULL
pca$V2<-NULL
colnames(pca)<-paste0("PC",1:20)
val<-read.table("pop2maf002pca.eigenval")
colnames(val)<-"val"
rownames(val)<-paste0("PC", 1:nrow(val))
load_strain<-t(pca)*sqrt(val$val)
###snp
geno<-read.table("pop2maf002.matrix",header = TRUE, row.names = NULL)
pos <- geno[, 1, drop = FALSE]
geno <- geno[, -1]  # 移除第一列（位置信息），只保留基因型数据
geno[geno=="A"]<- 0
geno[geno=="T"]<- 1
geno <- data.frame(lapply(geno, as.numeric))
load_snp <- load_strain %*% t(geno)
load_snp_squ<-load_snp^2
load_snp_df<-as.data.frame(t(load_snp))
load_snp_df$POS<-as.numeric(pos$row.names)
squdf<-as.data.frame(t(load_snp_squ))
squdf$POS<-as.numeric(pos$row.names)
plot(load_snp_df$POS,load_snp_df$PC1,type = "p")
ggplot(squdf,aes(x=POS,y=PC1))+
geom_point( alpha = 0.5, size = 3)+
labs(x = "SNP Position", y = "Squared PC1 Loading") +
theme_classic()+
theme(axis.line = element_line(colour = "black", linewidth = 1),
axis.text.x = element_text(size = 14),   # 设置x轴刻度标签的字体大小
axis.text.y = element_text(size = 14),   # 设置y轴刻度标签的字体大小
axis.title.x = element_text(size = 16),  # 设置x轴标题的字体大小（如果需要的话）
axis.title.y = element_text(size = 16), # 设置y轴标题的字体大小
plot.title = element_text(hjust = 0.5, size = 20),
legend.position = "none")+
geom_vline(xintercept = 250000,color="red")+geom_vline(xintercept = 270000,color="red")+
geom_vline(xintercept = 500000,color="red")+geom_vline(xintercept = 520000,color="red")+
geom_vline(xintercept = 750000,color="red")+geom_vline(xintercept = 770000,color="red")
###
###
library("CMplot")
cmdata <- data.frame(
SNP = paste0("ID", seq_len(nrow(squdf))),
CHR = 1,                  # 所有点都属于同一条染色体 → 不会丢点
BP  = squdf$POS,          # 真实 bp 位置，一点不丢
P   = squdf$PC1           # loading，全部保留
)
CMplot(
cmdata,
plot.type = "c",
type = "p",
LOG10 = FALSE,
r = 2,     # 控制中间空心大小
col = "#00000080",
signal.line = NULL,
outward = TRUE,
cex = 1,
signal.cex = 1,
cir.chr.h=.5,
chr.labels = FALSE,  # 不让 CMplot 自动写染色体号（因为只有 CHR=1）
dpi = 600,
file = "pdf",
file.output = TRUE
)
###vis_PCA
pca <- read.table("pop2maf002pca.eigenvec")
eigenval <- scan("pop2maf002pca.eigenval")
# remove nuisance column
rownames(pca)<-pca$V1
pca <- pca[,-c(1,2)]
colnames(pca) <- paste0("PC", 1:ncol(pca))
val<-read.table("pop2maf002pca.eigenval")
colnames(val)<-"val"
rownames(val)<-paste0("PC", 1:nrow(val))
pca<-as.data.frame(t(t(pca)*sqrt(val$val)))
# set names
pca$ind<-rownames(pca)
pca$pop <- sapply(strsplit(as.character(pca$ind), "_"), `[`, 1)
pca$pop <- sub("pop", "p", pca$pop)
##pve
pve <- data.frame(PC = 1:20, pve = eigenval/sum(eigenval)*100)
library(ggplot2)
ggplot(pve, aes(PC, pve)) + geom_bar(stat = "identity") +
ylab("Percentage variance explained") + theme_light()+
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_rect(colour = "black", fill = NA, linewidth = 1),
axis.text.x = element_text(size = 14),   # 设置x轴刻度标签的字体大小
axis.text.y = element_text(size = 14),   # 设置y轴刻度标签的字体大小
axis.title.x = element_text(size = 16),  # 设置x轴标题的字体大小（如果需要的话）
axis.title.y = element_text(size = 16),   # 设置y轴标题的字体大小（如果需要的话）
plot.title = element_text(size = 20)
)+
xlab("Principle Component")+
ggtitle("Scree Plot")
###
###
#
library(grid)
a<-ggplot(pve, aes(PC, pve)) + geom_bar(stat = "identity") +
ylab("PVE") + theme_light()+
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_rect(colour = "black", fill = NA, linewidth = 1),
axis.text.x = element_text(size = 12),   # 设置x轴刻度标签的字体大小
axis.text.y = element_text(size = 12),   # 设置y轴刻度标签的字体大小
axis.title.x = element_text(size = 13),  # 设置x轴标题的字体大小（如果需要的话）
axis.title.y = element_text(size = 13),   # 设置y轴标题的字体大小（如果需要的话）
plot.title = element_text(size = 12)
)+
xlab("Principal Component")+
ggtitle("Scree Plot")
scree_grob <- ggplotGrob(a)
ggplot(pca,aes(x=PC1,y=PC2,col = pop))+
geom_point(size=5,alpha=0.5)+
theme_light()+
xlab(paste0("PC1 (", signif(pve$pve[1], 3), "%)")) +
ylab(paste0("PC2 (", signif(pve$pve[2], 3), "%)"))+
theme(legend.title = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_rect(colour = "black", fill = NA, linewidth = 1),
axis.text.x = element_text(size = 14),   # 设置x轴刻度标签的字体大小
axis.text.y = element_text(size = 14),   # 设置y轴刻度标签的字体大小
axis.title.x = element_text(size = 16),  # 设置x轴标题的字体大小（如果需要的话）
axis.title.y = element_text(size = 16),
legend.text = element_text(size = 16),
legend.key.size = unit(2, "lines"))+
annotation_custom(grob = scree_grob, xmin = -0.8, xmax = 0.3, ymin = 0.4, ymax = 1.1)
ggplot(pca,aes(x=PC1,y=PC2,col = pop))+
geom_point(size=5,alpha=0.5)+
theme_light()+
xlab(paste0("PC1 (", signif(pve$pve[1], 3), "%)")) +
ylab(paste0("PC2 (", signif(pve$pve[2], 3), "%)"))+
scale_color_discrete(
name   = "Mutation rate",
labels = c("0", "1e-6")   # 对应 pop 里的 p1, p2
)+
theme(#legend.title = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_rect(colour = "black", fill = NA, linewidth = 1),
axis.text.x = element_text(size = 14),   # 设置x轴刻度标签的字体大小
axis.text.y = element_text(size = 14),   # 设置y轴刻度标签的字体大小
axis.title.x = element_text(size = 16),  # 设置x轴标题的字体大小（如果需要的话）
axis.title.y = element_text(size = 16),
legend.text = element_text(size = 16),
legend.key.size = unit(2, "lines"))+
annotation_custom(grob = scree_grob, xmin = -0.8, xmax = 0.3, ymin = 0.4, ymax = 1.1)
ggplot(pca,aes(x=PC1,y=PC2,col = pop))+
geom_point(size=5,alpha=0.5)+
theme_light()+
xlab(paste0("PC1 (", signif(pve$pve[1], 3), "%)")) +
ylab(paste0("PC2 (", signif(pve$pve[2], 3), "%)"))+
scale_color_discrete(
name   = "Mutation rate",
labels = c("0", "1e-6")   # 对应 pop 里的 p1, p2
)+
theme(legend.title = element_text(size = 16),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_rect(colour = "black", fill = NA, linewidth = 1),
axis.text.x = element_text(size = 14),   # 设置x轴刻度标签的字体大小
axis.text.y = element_text(size = 14),   # 设置y轴刻度标签的字体大小
axis.title.x = element_text(size = 16),  # 设置x轴标题的字体大小（如果需要的话）
axis.title.y = element_text(size = 16),
legend.text = element_text(size = 14),
legend.key.size = unit(2, "lines"))+
annotation_custom(grob = scree_grob, xmin = -0.8, xmax = 0.3, ymin = 0.4, ymax = 1.1)
ggplot(pca,aes(x=PC1,y=PC2,col = pop))+
geom_point(size=5,alpha=0.5)+
theme_light()+
xlab(paste0("PC1 (", signif(pve$pve[1], 3), "%)")) +
ylab(paste0("PC2 (", signif(pve$pve[2], 3), "%)"))+
scale_color_discrete(
name   = "Mutation rate",
labels = c("0", expression(10^-6))
)+
theme(legend.title = element_text(size = 16),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_rect(colour = "black", fill = NA, linewidth = 1),
axis.text.x = element_text(size = 14),   # 设置x轴刻度标签的字体大小
axis.text.y = element_text(size = 14),   # 设置y轴刻度标签的字体大小
axis.title.x = element_text(size = 16),  # 设置x轴标题的字体大小（如果需要的话）
axis.title.y = element_text(size = 16),
legend.text = element_text(size = 14),
legend.key.size = unit(2, "lines"))+
annotation_custom(grob = scree_grob, xmin = -0.8, xmax = 0.3, ymin = 0.4, ymax = 1.1)
###
library(ggtree)
library(treeio)
pop1tree<-read.newick("pop2_10000.FastTree")
colnames(pca)[21]<-"label"
tree.a<-full_join(pop1tree,pca,by="label")
ggtree(tree.a, layout = "ape") +
geom_tippoint(aes(color = pop),size=3) +
scale_color_manual(values = viridis(10, option = "E"),
breaks = paste0("p",c(1:10)))+
geom_treescale(offset = 0.01,fontsize=5, linesize=1, x=0, y=0,width=0.01)+
theme(legend.title = element_text(size = 14),
legend.text = element_text(size = 14),
legend.key.size = unit(2, "lines"),
legend.position = "none")
ggtree(tree.a, layout = "ape") +
geom_tippoint(aes(color = pop),size=3) +
geom_treescale(offset = 0.01,fontsize=5, linesize=1, x=0, y=0,width=0.01)+
theme(legend.title = element_text(size = 14),
legend.text = element_text(size = 14),
legend.key.size = unit(2, "lines"),
legend.position = "none")
ggtree(tree.a, layout = "ape") +
geom_tippoint(aes(color = pop),size=3) +
geom_treescale(offset = 0.05,fontsize=5, linesize=1, x=0, y=0,width=0.01)+
theme(legend.title = element_text(size = 14),
legend.text = element_text(size = 14),
legend.key.size = unit(2, "lines"),
legend.position = "none")
ggtree(tree.a, layout = "ape") +
geom_tippoint(aes(color = pop),size=3) +
geom_treescale(offset = 0.01,fontsize=5, linesize=1, x=0, y=0,width=0.01)+
theme(legend.title = element_text(size = 14),
legend.text = element_text(size = 14),
legend.key.size = unit(2, "lines"),
legend.position = "none")
ggtree(tree.a, layout = "ape") +
geom_tippoint(aes(color = pop),size=3，alpha=0.5) +
ggtree(tree.a, layout = "ape") +
geom_tippoint(aes(color = pop),size=3,alpha=0.5) +
geom_treescale(offset = 0.01,fontsize=5, linesize=1, x=0, y=0,width=0.01)+
theme(legend.title = element_text(size = 14),
legend.text = element_text(size = 14),
legend.key.size = unit(2, "lines"),
legend.position = "none")
