for (i in c(1:10)) {
assign(paste0("g",i),read.table(paste0("./out_vcf/pop1_",i,"0000.vcf"), skip = 13, header = TRUE,
sep = "\t",comment.char = "",check.names = FALSE,
stringsAsFactors = FALSE))
}
for (i in c(1:10)) {
current_df <- get(paste0("g", i))  # 获取当前的数据框
current_df$ID <- current_df$POS
colnames(current_df)[10:509] <- paste0("pop1","_",c(1:500))
current_df$ALT<-"T"
write.table(current_df,paste0("vcf_pop/pop1_generation_",i,"0000.vcf"),
sep = "\t",col.names = TRUE,row.names = FALSE,quote = FALSE)
assign(paste0("g", i), current_df)  # 将修改后的数据框重新赋值
}
###matrix
for (i in c(1:10)) {
pop<-get(paste0("g", i))
ma<-pop[c("POS",paste0("pop1_",c(1:500)))]
ma[ma==0]<-"A"
ma[ma==1]<-"T"
write.table(ma,paste0("vcf_pop/pop1_G",i,"0000.MajorAMinorT"),row.names = FALSE,col.names = TRUE,
sep = "\t",quote = FALSE)
}
for (i in c(1:10)) {
assign(paste0("g",i),read.table(paste0("./out_vcf/pop1_",i,"0000.vcf"), skip = 13, header = TRUE,
sep = "\t",comment.char = "",check.names = FALSE,
stringsAsFactors = FALSE))
}
for (i in c(1:10)) {
current_df <- get(paste0("g", i))  # 获取当前的数据框
current_df$ID <- current_df$POS
colnames(current_df)[10:509] <- paste0("pop1","_",c(1:500))
current_df$ALT<-"T"
write.table(current_df,paste0("vcf_pop/pop1_generation_",i,"0000.vcf"),
sep = "\t",col.names = TRUE,row.names = FALSE,quote = FALSE)
assign(paste0("g", i), current_df)  # 将修改后的数据框重新赋值
}
###matrix
for (i in c(1:10)) {
pop<-get(paste0("g", i))
ma<-pop[c("POS",paste0("pop1_",c(1:500)))]
ma[ma==0]<-"A"
ma[ma==1]<-"T"
write.table(ma,paste0("vcf_pop/pop1_G",i,"0000.MajorAMinorT"),row.names = FALSE,col.names = TRUE,
sep = "\t",quote = FALSE)
}
###score
df<-read.table("score_m1m2/score_g10000.txt")
df
rownames(df)<-df$V1
df$V1<-NULL
df<-as.data.frame(t(df))
View(df)
#m1<-as.data.frame(df[c(TRUE,FALSE),])
#m2<-as.data.frame(df[c(FALSE,TRUE),])
#ndf<-data.frame(m1=m1$`df[c(TRUE, FALSE), ]`,m2=m2$`df[c(FALSE, TRUE), ]`)
df$scores<-df$m1-df$m2
hist(df$scores)
df
max(df$m1)
max(df$m2)
###score
df<-read.table("score_m1m2/text.txt")
hist(df$V1)
###score
df<-read.table("score_m1m2/text.txt")
hist(df$V1)
hist(df$V1,breaks = 100)
###score
df<-read.table("score_m1m2/text.txt")
hist(df$V1,breaks = 100)
###score
df<-read.table("score_m1m2/text.txt")
hist(df$V1,breaks = 100)
###score
df<-read.table("score_m1m2/text.txt")
hist(df$V1,breaks = 100)
df<-[-1]
df<-[-1,]
df$score<-"score"
df<-[-1,]
df<-df[-1,]
hist(df$V1)
###score
df<-read.table("score_m1m2/text.txt")
df<-df[-1,]
hist(df$V1，breaks=100)
hist(df)
hist(df,breaks = 100)
###score
df<-read.table("score_m1m2/text.txt")
df<-df[-1,]
hist(df,breaks = 100)
for (i in c(1:10)) {
assign(paste0("g",i),read.table(paste0("./out_vcf/pop1_",i,"0000.vcf"), skip = 13, header = TRUE,
sep = "\t",comment.char = "",check.names = FALSE,
stringsAsFactors = FALSE))
}
for (i in c(1:10)) {
current_df <- get(paste0("g", i))  # 获取当前的数据框
current_df$ID <- current_df$POS
colnames(current_df)[10:509] <- paste0("pop1","_",c(1:500))
current_df$ALT<-"T"
write.table(current_df,paste0("vcf_pop/pop1_generation_",i,"0000.vcf"),
sep = "\t",col.names = TRUE,row.names = FALSE,quote = FALSE)
assign(paste0("g", i), current_df)  # 将修改后的数据框重新赋值
}
###matrix
for (i in c(1:10)) {
pop<-get(paste0("g", i))
ma<-pop[c("POS",paste0("pop1_",c(1:500)))]
ma[ma==0]<-"A"
ma[ma==1]<-"T"
write.table(ma,paste0("vcf_pop/pop1_G",i,"0000.MajorAMinorT"),row.names = FALSE,col.names = TRUE,
sep = "\t",quote = FALSE)
}
###score
df<-read.table("score_m1m2/score_g100000.txt")
df<-as.data.frame(df[-1,])
hist(as.numeric(df$`df[-1, ]`),xlab = "score_m1m2",ylab = "freq",main = "inds5_100bp_g100000",
breaks = 50)
###score
df<-read.table("score_m1m2/score_g10000.txt")
df<-as.data.frame(df[-1,])
hist(as.numeric(df$`df[-1, ]`),xlab = "score_m1m2",ylab = "freq",main = "inds5_100bp_g10000",
breaks = 50)
###score
df<-read.table("score_m1m2/score_g10000.txt")
df<-as.data.frame(df[-1,])
hist(as.numeric(df$`df[-1, ]`),xlab = "score_m1m2",ylab = "freq",main = "inds5_100bp_g10000",
breaks = 50)
###score
df<-read.table("score_m1m2/score_g20000.txt")
df<-as.data.frame(df[-1,])
hist(as.numeric(df$`df[-1, ]`),xlab = "score_m1m2",ylab = "freq",main = "inds5_100bp_g20000",
breaks = 50)
###score
df<-read.table("score_m1m2/score_g20000.txt")
df<-as.data.frame(df[-1,])
hist(as.numeric(df$`df[-1, ]`),xlab = "score_m1m2",ylab = "freq",main = "inds5_100bp_g20000",
breaks = 50)
hist(as.numeric(df$`df[-1, ]`),xlab = "score_m1m2",ylab = "freq",main = "inds1_1kb_g10000",
breaks = 50)
###g10000
g1<-read.table("./out_vcf/pop1_10000.vcf", skip = 13, header = TRUE,
sep = "\t",comment.char = "",check.names = FALSE,
stringsAsFactors = FALSE)
View(g1)
###g10000
g1<-read.table("./out_vcf/pop1_10000.vcf",
skip = 13, header = TRUE,
sep = "\t", comment.char = "", check.names = FALSE,
stringsAsFactors = FALSE)
View(g1)
g1$stat<-rowSums(g1[,10:509])
View(g1)
g1maf002<-g1[g1$stat<(0.98*500),]
View(g1maf002)
g1maf002<-g1[g1$stat>(0.02*500),]
View(g1maf002)
g1maf002<-g1[g1$stat>=(0.02*500),]
View(g1maf002)
###g10000
g1<-read.table("./out_vcf/pop1_10000.vcf",
skip = 13, header = TRUE,
sep = "\t", comment.char = "", check.names = FALSE,
stringsAsFactors = FALSE)
g1$stat1<-rowSums(g1[,10:509])
g1$stat2<-(500-g1$stat1)
View(g1)
g1maf002<-g1[apply(g1[,c("stat1","stat2")], 1, max)<(500*0.98),]
View(g1maf002)
g1maf002vcf<-g1maf002[,1:509]
View(g1maf002vcf)
g1maf002vcf$ID <- g1maf002vcf$POS
View(g1)
g1maf002vcf$ALT<-"T"
write.table(current_df,"vcf_pop/ge10000maf002.vcf",
sep = "\t",col.names = TRUE,row.names = FALSE,quote = FALSE)
write.table(g1maf002vcf,"vcf_pop/ge10000maf002.vcf",
sep = "\t",col.names = TRUE,row.names = FALSE,quote = FALSE)
###g10000
g1<-read.table("./out_vcf/pop1_10000.vcf",
skip = 13, header = TRUE,
sep = "\t", comment.char = "", check.names = FALSE,
stringsAsFactors = FALSE)
g1$stat1<-rowSums(g1[,10:509])
g1$stat2<-(500-g1$stat1)
g1maf002<-g1[apply(g1[,c("stat1","stat2")], 1, max)<(500*0.98),]
g1maf002vcf<-g1maf002[,1:509]
g1maf002vcf$ID <- g1maf002vcf$POS
g1maf002vcf$ALT<-"T"
colnames(g1maf002vcf)[10:509] <- paste0("pop1","ind",c(1:500))
View(g1maf002vcf)
write.table(g1maf002vcf,"vcf_pop/ge10000maf002.vcf",
sep = "\t",col.names = TRUE,row.names = FALSE,quote = FALSE)
###matrix
ma<-g1maf002vcf[c("POS",paste0("pop1ind",c(1:500)))]
View(ma)
ma[ma==0]<-"A"
ma[ma==1]<-"T"
View(ma)
View(g1maf002)
colnames(ma)[1]<-NA
View(ma)
write.table(ma,"vcf_pop/pop1_G10000.MajorAMinorT",
row.names = FALSE,col.names = TRUE,
sep = "\t",quote = FALSE)
###matrix
ma<-g1maf002vcf[c("POS",paste0("pop1ind",c(1:500)))]
ma[ma==0]<-"A"
ma[ma==1]<-"T"
write.table(ma,"vcf_pop/pop1_G10000.MajorAMinorT",
row.names = FALSE,col.names = TRUE,
sep = "\t",quote = FALSE)
apply(g1[,c("stat1","stat2")], 1, max)
View(g1)
